;调教后性交渉追加版(2008/04/17 byα)
;夜、厳しい条件を阴蒂アすると…？
@SELF_CHECK
SIF COND("大被同眠") || COND("大被同眠", MASTER)
	RETURN 0

;调教后事件之記录初期化
CVARSET CFLAG, 92, 0

;念之ため、PLAYERをMASTERに直す
PLAYER = MASTER

;MASTERと之絡み
SIF ABL:欲望 && RAND:2
	CALL SELF_CHECK_PLAY, MASTER
;自慰
SIF ABL:欲望 && ABL:自慰成瘾 && RAND:4 == 0
	CALL SELF_CHECK_PLAY, TARGET

;助手と之絡み
IF ASSI && ABL:欲望 && RAND:2
	;PLAYERをASSIにする
	PLAYER = ASSI
	CALL SELF_CHECK_PLAY, ASSI
ENDIF

;PLAYERをMASTERに直す
PLAYER = MASTER


@SELF_CHECK_PLAY, ARG
VARSET LOCAL
;事件之決定(ARG使う之はここだけ)
CALL PLAY_SELF, ARG
LOCALS = %STR:100%
SIF LOCALS == ""
	RETURN 0

;基本回数は精力依存
LOCAL = BASE:精力/20 + LIMIT(RAND:(BASE:精力/10 + 1), 1, BASE:精力/15)

SELECTCASE LOCALS
CASE "调教后性爱"
	;V感觉、淫穴によるBＯＮＵS
	LOCAL += MAX(ABL:V感觉/3, 0) + TALENT:淫穴

	IF LOCAL > 0
		DRAWLINE

		CALL SIMULATE_TRAIN_FIRST

		IF PLAYER == MASTER
			IF BASE:PLAYER:精力
				PRINTFORML %CALLNAME:PLAYER%和%CALLNAME:TARGET%都还欲火旺盛亢奋不已、
				PRINTFORML 满身大汗在床上继续性交…

				CALL SIMULATE_TRAIN_COM, 60, LOCAL
			ELSEIF BASE:PLAYER:精力 * 2 >= MAXBASE:PLAYER:精力
				PRINTFORML 兴奋不已的%CALLNAME:TARGET%、
				PRINTFORML 如饥似渴的推倒%CALLNAME:PLAYER%为了满足自己的欲望压了过来…

				TEQUIP:逆推 = 1
				CALL SIMULATE_TRAIN_COM, 65, LOCAL
			ELSE
				PRINTFORML 感觉身体欲火高涨的%CALLNAME:TARGET%、
				PRINTFORML 对疲惫的%CALLNAME:PLAYER%进行超越极限的榨精…
				TEQUIP:逆推 = 1
				CALL SIMULATE_TRAIN_COM, 65, LOCAL
			ENDIF

			CALL SELF_KOJO, LOCALS

			PRINTL 
			IF ABL:顺从 + ABL:欲望 + ABL:V感觉 >= 13 && COND("欲求不满")
				PRINTFORML %CALLNAME:TARGET%一边用舌头舔着%CALLNAME:PLAYER%的那里进行清洁、
				PRINTFORMW 一边依依不舍的从下面看着%CALLNAME:PLAYER%…
				PRINTFORMW 但是%CALLNAME:PLAYER%假装没看到那个视线、离开了房间…


				CALL SIMULATE_TRAIN_COM, 91, 1
			ELSEIF TALENT:偏爱 + TALENT:相思相爱 && RAND:2
				IF TALENT:PLAYER:无视脏污 && ABL:S属性 >= 3 && RAND:5 == 0
					PRINTFORMW %CALLNAME:PLAYER%一脸满足的样子用舌头舔干净%CALLNAME:TARGET%的漂亮小穴后、离开了房间…

					CALL SIMULATE_TRAIN_COM, 1, LOCAL
				ELSE
					PRINTFORMW %CALLNAME:PLAYER%一脸满足的样子帮%CALLNAME:TARGET%擦拭干净那漂亮的娇躯、离开了房间…

				ENDIF
			ELSE
				PRINTFORMW %CALLNAME:PLAYER%一脸满足的样子棒%CALLNAME:TARGET%清洁了漂亮的肉棒、离开了房间…
				CALL SIMULATE_TRAIN_COM, 91, 1
			ENDIF
		ELSE
			PRINTFORML 调教后%CALLNAME:TARGET%和%CALLNAME:ASSI%、被涌出的欲望动摇抱在了一起…
			PRINTFORML 只有这个时候%CALLNAME:MASTER%的事才会从脑海中遗忘、
			PRINTFORM 像野兽一样不知疲倦的


			IF TIME == 0
				PRINTFORM 直到黄昏
			ELSE
				PRINTFORM 一整夜
			ENDIF
			PRINTFORML 互相贪图着快感…

			CALL SIMULATE_TRAIN_COM, 61, LOCAL
			CALL SELF_KOJO, LOCALS
		ENDIF

		;经验や珠など之獲得量计算
		CALL SIMULATE_TRAIN_CALC
		;結果发表
		CALL SIMULATE_TRAIN_SHOW

		CALL CALC, "欲求不满解消", TARGET, LOCAL
	ENDIF
CASE "调教后A性爱"
	;A感觉、尻穴狂によるBＯＮＵS
	LOCAL += MAX(ABL:A感觉/3, 0) + TALENT:尻穴狂

	IF LOCAL > 0
		DRAWLINE

		CALL SIMULATE_TRAIN_FIRST

		IF PLAYER == MASTER
			IF BASE:PLAYER:精力
				PRINTFORML %CALLNAME:PLAYER%和%CALLNAME:TARGET%都还欲火旺盛亢奋不已、
				PRINTFORML 满身大汗在床上继续用肛门性交…

				CALL SIMULATE_TRAIN_COM, 71, LOCAL
			ELSEIF BASE:PLAYER:精力 * 2 >= MAXBASE:PLAYER:精力
				PRINTFORML 肛门疼起来兴奋不已的%CALLNAME:TARGET%、
				PRINTFORML 如饥似渴的推倒%CALLNAME:PLAYER%为了满足自己的欲望压了过来…

				TEQUIP:逆推 = 1
				CALL SIMULATE_TRAIN_COM, 75, LOCAL
			ELSE
				PRINTFORML 感觉身体欲火高涨的%CALLNAME:TARGET%は、
				PRINTFORML 用肛门对疲惫的%CALLNAME:PLAYER%进行超越极限的榨精…

				TEQUIP:逆推 = 1
				CALL SIMULATE_TRAIN_COM, 75, LOCAL
			ENDIF
			CALL SELF_KOJO, LOCALS

			IF ABL:顺从 + ABL:欲望 >= 8 && COND("欲求不满")
				PRINTL 
				PRINTFORMW %CALLNAME:TARGET%依依不舍的拉了下%CALLNAME:PLAYER%的袖子

				PRINTFORMW 但是%CALLNAME:PLAYER%抽出那只手、离开了房间…
			ENDIF
		ELSE
			PRINTFORML 调教后%CALLNAME:TARGET%和%CALLNAME:ASSI%、身体发热的抱在了一起…
			PRINTFORML 被涌出的欲望动摇、只有这个时候%CALLNAME:MASTER%的事才会从脑海中遗忘
			PRINTFORM 像野兽一样不知疲倦的


			IF TIME == 0
				PRINTFORM 直到黄昏
			ELSE
				PRINTFORM 一整夜
			ENDIF
			PRINTFORML 贪图着%CALLNAME:TARGET%肛门的快感…
			CALL SIMULATE_TRAIN_COM, 71, LOCAL
			CALL SELF_KOJO, LOCALS
		ENDIF

		;经验や珠など之獲得量计算
		CALL SIMULATE_TRAIN_CALC
		;結果发表
		CALL SIMULATE_TRAIN_SHOW

		CALL CALC, "欲求不满解消", TARGET, LOCAL
	ENDIF
CASE "调教后百合PLAY"

	;C感觉、淫核によるBＯＮＵS
	LOCAL += MAX(ABL:C感觉/3, 0) + TALENT:淫核

	IF LOCAL > 0
		DRAWLINE

		CALL SIMULATE_TRAIN_FIRST

		IF PLAYER == MASTER
			IF BASE:PLAYER:精力
				PRINTFORML %CALLNAME:PLAYER%和%CALLNAME:TARGET%都还欲火旺盛亢奋不已、
				PRINTFORML 屡次互相安慰彼此的发热的身体直到高潮了…

				CALL SIMULATE_TRAIN_COM, 1, RAND:LOCAL + 1
				CALL SIMULATE_TRAIN_COM, 98, RAND:LOCAL + 1
			ELSE
				PRINTFORML 兴奋不已的%CALLNAME:TARGET%、如饥似渴的推倒了
				SIF BASE:PLAYER:精力 * 2 < MAXBASE:PLAYER:精力
					PRINT 疲惫的

				PRINTFORML %CALLNAME:PLAYER%互相摩擦着小穴…
				CALL SIMULATE_TRAIN_COM, 98, RAND:LOCAL + 1
			ENDIF

			CALL SIMULATE_TRAIN_COM, 80, LOCAL
			CALL SELF_KOJO, LOCALS
			IF ABL:顺从 + ABL:欲望 >= 8 && COND("欲求不满")
				PRINTL 
				PRINTFORMW %CALLNAME:TARGET%依依不舍的拉了下%CALLNAME:PLAYER%的袖子

				PRINTFORMW 但是%CALLNAME:PLAYER%抽出那只手、离开了房间…
			ENDIF
		ELSE
			PRINTFORML 调教后%CALLNAME:TARGET%和%CALLNAME:ASSI%、春心荡漾的抱在一起…
			PRINTFORML 被涌出的欲望动摇、只有这个时候%CALLNAME:MASTER%的事才会从脑海中遗忘
			PRINTFORM 像野兽一样不知疲倦的


			IF TIME == 0
				PRINTFORM 直到黄昏
			ELSE
				PRINTFORM 一整夜
			ENDIF

			CALL SIMULATE_TRAIN_COM, 1, RAND:LOCAL + 1
			CALL SIMULATE_TRAIN_COM, 98, RAND:LOCAL + 1
			CALL SIMULATE_TRAIN_COM, 80, LOCAL/2 + 1

			IF TALENT:扶她 && TALENT:PLAYER:扶她
				PRINTFORML 互相摩擦着彼此的小穴、贪图着肉棒被吸吮的快感…

				CALL SIMULATE_TRAIN_COM, 91, LOCAL/2 + 1
			ELSE
				PRINTFORML 互相摩擦着彼此的小穴、贪图着快感…

			ENDIF
			CALL SELF_KOJO, LOCALS

			SWAP PLAYER, TARGET
			CALL SIMULATE_TRAIN_COM, 80, LOCAL/2 + 1
			CALL SIMULATE_TRAIN_COM, 91, LOCAL/2 + 1
			SWAP PLAYER, TARGET
		ENDIF

		;经验や珠など之獲得量计算
		CALL SIMULATE_TRAIN_CALC
		;結果发表
		CALL SIMULATE_TRAIN_SHOW

		CALL CALC, "欲求不满解消", TARGET, LOCAL
	ENDIF
CASE "调教后自慰"
	LOCAL += RAND:(ABL:自慰成瘾 + 1)
	IF LOCAL > 0
		DRAWLINE
		PRINTFORM %CALLNAME:PLAYER%出去后、%CALLNAME:TARGET%
		SIF TALENT:恋慕
			PRINTFORML 一边想着%CALLNAME:PLAYER%的事、

		;拳交标志
		A = 0
		B = 0

		IF GETBIT(CHECK_ONANIE(SELECTCOM), 0) && PENIS(TARGET)
			PRINT 一边套弄肉棒一样在

		ELSEIF GETBIT(CHECK_ONANIE(SELECTCOM), 1)
			IF RAND:2 == 0
				PRINT 私处

			ELSE
				PRINT 秘所
			ENDIF
			IF EXP:V拳交经验 >= 5 && TALENT:处女 == 0 && ABL:V扩张 >= 4 && RAND:3 == 0
				IF RAND:2
					PRINT 用自己的拳头摩擦

				ELSE
					PRINT 用自己的拳头插入

				ENDIF
				A = 2
				B = 10
				LOCAL = MAX(1, LOCAL/2)
			ELSEIF RAND:3 == 0
				PRINT 玩弄自己的手指

			ELSEIF RAND:2 == 0
				PRINT 用自己的手指挖弄

			ELSE
				PRINT 吞吐自己的手指

			ENDIF
		ELSEIF GETBIT(CHECK_ONANIE(SELECTCOM), 2)
			IF RAND:2 == 0
				PRINT 肛门

			ELSE
				PRINT 屁股小穴

			ENDIF
			IF EXP:A拳交经验 >= 5 && ABL:A扩张 >= 4 && RAND:3 == 0
				IF RAND:2
					PRINT 用自己的拳头摩擦

				ELSE
					PRINT 用自己的拳头插入

				ENDIF
				A = 2
				B = 10
				LOCAL = MAX(1, LOCAL/2)
			ELSEIF RAND:3 == 0
				PRINT 玩弄自己的手指

			ELSEIF RAND:2 == 0
				PRINT 用自己的手指挖弄

			ELSE
				PRINT 吞吐自己的手指

			ENDIF
		ELSE
			IF RAND:2 == 0
				PRINT 阴蒂
			ELSE
				PRINT 秘处

			ENDIF
			PRINTFORM 用自己的%NAMES("指")%
			IF RAND:3 == 0
				PRINT 摩擦

			ELSEIF RAND:2 == 0
				PRINT 玩弄

			ELSE
				PRINT 旋转

			ENDIF
		ENDIF
		PRINTFORML 自慰了{LOCAL}次。

		CALL SELF_KOJO, LOCALS

		PRINTFORML %EXPNAME:10%＋{LOCAL}
		EXP:自慰经验 += LOCAL

		PRINTFORML %EXPNAME:2%＋{LOCAL}
		EXP:绝顶经验 += LOCAL
		IF TALENT:性别女 == 0
			PRINTFORML %EXPNAME:3%＋{LOCAL}
			EXP:射精经验 += LOCAL
		ENDIF

		IF GETBIT(CHECK_ONANIE(SELECTCOM), 1)
			PRINTFORML %EXPNAME:0%＋{LOCAL+B}
			EXP:V经验 += LOCAL+B
			SIF A
				PRINTFORML %EXPNAME:53%＋{LOCAL * A}
			EXP:V扩张经验 += LOCAL * A
			PRINTFORML %PALAMNAME:1%之珠＋{(LOCAL+B) * 200}
			JUEL:快V += (LOCAL+B) * 200
		ELSEIF GETBIT(CHECK_ONANIE(SELECTCOM), 2)
			PRINTFORML %EXPNAME:1%＋{LOCAL+B}
			EXP:A经验 += LOCAL+B
			SIF A
				PRINTFORML %EXPNAME:57%＋{LOCAL * A}
			EXP:A扩张经验 += LOCAL * A
			PRINTFORML %PALAMNAME:2%之珠＋{(LOCAL+B) * 200}
			JUEL:快A += (LOCAL+B) * 200
		ELSE
			PRINTFORML %PALAMNAME:0%之珠＋{LOCAL * 500}
			JUEL:快C += LOCAL * 500
		ENDIF

		PRINTFORML %PALAMNAME:4%之珠＋{LOCAL * 100}
		JUEL:恭顺 += LOCAL * 100
		PRINTFORMW %PALAMNAME:5%之珠＋{(LOCAL+B) * 250}
		JUEL:欲情 += (LOCAL+B) * 250

		BASE:体力 = MAX(BASE:体力 - (LOCAL+B)*50, 1)
		BASE:气力 = MAX(BASE:气力 - (LOCAL+B)*30, 0)

		IF ABL:顺从 + ABL:欲望 + ABL:自慰成瘾 >= 10 && TIME == 0
			PRINTFORML 这件事%CALLNAME:TARGET%报告了%CALLNAME:PLAYER%。
			PRINTFORML %PALAMNAME:8%之珠＋{(LOCAL+B) * 200}
			JUEL:恥情 += (LOCAL+B) * 200
		ENDIF

		SIF ABL:顺从 == 5 || ABL:欲望 == 5
			PRINTFORMW 可是几次试着安慰自己、对%CALLNAME:PLAYER%的欲望都没有满足…

	ENDIF
ENDSELECT

;调教后事件之記录
IF LOCALS != "" && LOCAL
	CFLAG:PLAYER:92 = NUM_EV(LOCALS)
	CFLAG:92 = NUM_EV(LOCALS)
	DRAWLINE
ENDIF

@PLAY_SELF, ARG
#DIM LCOUNT
STR:100 = 
;恋慕、淫乱による调教后性交渉チェック
SIF BASE:PLAYER:精力 == 0 || TALENT:淫乱 + TALENT:恋慕 == 0
	RETURN 0
;体力を技巧果たした
SIF BASE:体力 < 500 || BASE:精力 <= 0
	RETURN 0
;性欲大满足
SIF BASE:精液欲 >= MAXBASE:精液欲*2
	RETURN 0

;助手と之PLAYが发生するか
IF ARG == ASSI && ABL:顺从 >= 3 && ABL:欲望 >= 3
	;相性がよいことが条件
	SIF RELATION:(NO:ASSI) < 120 || RELATION:ASSI:(NO:TARGET) < 120
		RETURN 0
ENDIF

VARSET LOCALS

IF ARG == PLAYER
	;V性爱
	CALL COM_ABLE65
	SIF RESULT && PENIS(PLAYER) && ABL:V感觉 >= 3 && TALENT:处女 + TALENT:PLAYER:童贞 == 0
		LOCALS:0 = 调教后性爱
	;A性爱
	CALL COM_ABLE75
	SIF RESULT && PENIS(PLAYER) && EXP:PLAYER:A插入经验 && COND("ベテラン：A性爱")
		LOCALS:1 = 调教后A性爱
	;百合PLAY
ELSEIF ARG == TARGET
	;自慰
	SIF ABL:自慰成瘾 >= 3 && PLAYER == MASTER
		LOCALS:0 = 调教后自慰
ENDIF
LOCAL = 1
FOR LCOUNT, 0, 10
	SIF LOCALS:LCOUNT == ""
		CONTINUE
	SIF RAND:LOCAL == 0
		STR:100 = %LOCALS:LCOUNT%
	LOCAL += 1
NEXT
RETURN 0

