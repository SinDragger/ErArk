@TRADE,ARG
#DIM INDEX
$INPUT_LOOP
PRINTFORML %COUNTRY_NAME:ARG%可用贸易订单：
DRAWLINE
PRINTLC 贸易物品    
PRINTLC 贸易数量      
PRINTLC 报酬物品    
PRINTLC 报酬物品数量    
PRINTLC 罚款  
PRINTLC 完成时间（天）
PRINTL
REPEAT 99
    IF TRADE_ORDER:COUNT:1 ==ARG
        PRINTFORMLC [{TRADE_ORDER:COUNT:0}]%ITEMNAME:(TRADE_ORDER:COUNT:2)%     
        PRINTFORMLC {TRADE_ORDER:COUNT:3}   
        PRINTFORMLC \@TRADE_ORDER:COUNT:5?%ITEMNAME:(TRADE_ORDER:COUNT:5)%#龙门币\@   
        PRINTFORMLC {TRADE_ORDER:COUNT:6}
        PRINTFORMLC {TRADE_ORDER:COUNT:7} 
        PRINTFORMLC {TRADE_ORDER:COUNT:8}
        PRINTL
    ENDIF
REND
DRAWLINE
PRINTL [999]返回

INPUT
SIF RESULT==999
    RETURN
LOCAL = RESULT
PRINTFORML 你确定要接下这个订单吗？规定时间内完不成将扣除{TRADE_ORDER:LOCAL:7}罚款
PRINTL [1]确定 [0]算了
INPUT
IF RESULT
    FOR INDEX,0,99
        IF ORDER_GAINED:INDEX:1==0
            REPEAT 9
                ORDER_GAINED:INDEX:COUNT=TRADE_ORDER:LOCAL:COUNT
                TRADE_ORDER:LOCAL:COUNT=0
            REND
            ORDER_GAINED:INDEX:0=INDEX
            BREAK
        ENDIF
    NEXT
ENDIF
GOTO INPUT_LOOP

@TURNEND_TRADE
#DIM COUNT2
REPEAT 99
	IF ORDER_GAINED:COUNT:1
		IF ITEM:(ORDER_GAINED:COUNT:2)>=ORDER_GAINED:COUNT:4
			PRINTFORML 交付了{ORDER_GAINED:COUNT:4}%ITEMNAME:(ORDER_GAINED:COUNT:2)%
			PRINTFORMW 订单{COUNT}交付完成
			ITEM:(ORDER_GAINED:COUNT:2) -= ORDER_GAINED:COUNT:4
            VARSET ORDER_GAINED:COUNT:0,0,0,9
		ELSEIF ITEM:(ORDER_GAINED:COUNT:2)>0
			PRINTFORML 交付了{ITEM:(ORDER_GAINED:COUNT:2)}%ITEMNAME:(ORDER_GAINED:COUNT:2)%
			ORDER_GAINED:COUNT:4 -= ITEM:(ORDER_GAINED:COUNT:2)
			PRINTFORMW 订单{COUNT}还剩{ORDER_GAINED:COUNT:4}%ITEMNAME:(ORDER_GAINED:COUNT:2)%
			ITEM:(ORDER_GAINED:COUNT:2)=0
		ENDIF
	ENDIF
REND

REPEAT 98
    IF ORDER_GAINED:COUNT:1==0
        FOR COUNT2,0,9
            ORDER_GAINED:COUNT:COUNT2=ORDER_GAINED:(COUNT+1):COUNT2
            ORDER_GAINED:(COUNT+1):COUNT2=0
        NEXT
    ENDIF
REND

;IF DAY%7==0
    PRINTW 贸易订单刷新了
    VARSET TRADE_ORDER,0
    CALL ADD_TRADE(1,50,1,0,1000,1000,7)

;0表示贸易对象，1表示贸易物品，2表示贸易数量，3表示报酬物品（0代表龙门币），4表示报酬数量，5表示罚款，6完成时间（天）
@ADD_TRADE,ARG:0,ARG:1,ARG:2,ARG:3,ARG:4,ARG:5,ARG:6  
REPEAT 99
    IF TRADE_ORDER:COUNT:1 ==0
        SIF COUNT>0 
            TRADE_ORDER:COUNT:0 ==(TRADE_ORDER:(COUNT-1):0)+1
        TRADE_ORDER:COUNT:1=ARG:0
        TRADE_ORDER:COUNT:2=ARG:1
        TRADE_ORDER:COUNT:3=ARG:2
        TRADE_ORDER:COUNT:4=ARG:2
        TRADE_ORDER:COUNT:5=ARG:3
        TRADE_ORDER:COUNT:6=ARG:4
        TRADE_ORDER:COUNT:7=ARG:5
        TRADE_ORDER:COUNT:8=ARG:6
        BREAK
    ENDIF
REND
